---
import Layout from "../../layouts/Layout.astro";
import SEO from "../../components/SEO.astro";
import { getCollection, getEntryBySlug } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("posts");

  return posts.map((post) => ({
    params: { slug: post.slug },
  }));
}

const { slug } = Astro.params;

const post = await getEntryBySlug("posts", slug);
if (!post) {
  throw new Error(`Post no encontrado: ${slug}`);
}

const { Content } = await post.render();
---
<Layout title={`${post.data.title} â€” Juan Cruz Miranda`}>
  <SEO
    title={post.data.title}
    description={post.data.description}
    image="/og-default.png"
    type="article"
  />
  <h1>{post.data.title}</h1>

  <p style="color:#888; margin-bottom: 1.5rem;">
    {post.data.pubDate.toLocaleDateString()}
  </p>

  <article class="post-body">
    <Content />
  </article>
</Layout>
